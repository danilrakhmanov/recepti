<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üç≥ –ö–Ω–∏–≥–∞ –†–µ—Ü–µ–ø—Ç–æ–≤</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–†–µ—Ü–µ–ø—Ç—ã">
    <meta name="theme-color" content="#ff6b9d">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/2919/2919586.png" sizes="512x512">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2919/2919586.png">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&family=Pacifico&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <canvas id="particlesCanvas" class="particles-canvas"></canvas>
    
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-spinner">
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
            </div>
            <div class="loading-text">
                <span class="loading-emoji">üç≥</span>
                <span class="loading-message">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤...</span>
            </div>
        </div>
    </div>

    <!-- Theme Toggle -->
    <button class="theme-toggle" id="themeToggle" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
        <span class="theme-icon">üåô</span>
    </button>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="title">
                <span class="title-text">–ö–Ω–∏–≥–∞ –†–µ—Ü–µ–ø—Ç–æ–≤</span>
            </h1>
            <p class="subtitle">–°–æ—Ö—Ä–∞–Ω—è–π –ª—é–±–∏–º—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</p>
        </header>

        <!-- Add Recipe Button -->
        <button class="add-recipe-btn" id="addRecipeBtn">
            <span class="btn-icon">üç≥</span>
            <span class="btn-text">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</span>
        </button>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <button class="quick-action-btn planner-quick-btn" data-filter="planner">
                <span class="quick-action-icon">üìÖ</span>
                <span class="quick-action-text">–ú–µ–Ω—é</span>
            </button>
            <button class="quick-action-btn shopping-quick-btn" data-filter="shopping">
                <span class="quick-action-icon">üõí</span>
                <span class="quick-action-text">–ü–æ–∫—É–ø–∫–∏</span>
            </button>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="üîç –ü–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤...">
        </div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <button class="tab-btn active" data-filter="all">
                <span class="tab-icon">üìñ</span>
                <span class="tab-text">–í—Å–µ</span>
            </button>
            <button class="tab-btn" data-filter="first">
                <span class="tab-icon">üç≤</span>
                <span class="tab-text">–ü–µ—Ä–≤—ã–µ –±–ª—é–¥–∞</span>
            </button>
            <button class="tab-btn" data-filter="second">
                <span class="tab-icon">üçù</span>
                <span class="tab-text">–í—Ç–æ—Ä—ã–µ –±–ª—é–¥–∞</span>
            </button>
            <button class="tab-btn" data-filter="salads">
                <span class="tab-icon">ü•ó</span>
                <span class="tab-text">–°–∞–ª–∞—Ç—ã</span>
            </button>
            <button class="tab-btn" data-filter="snacks">
                <span class="tab-icon">üç¢</span>
                <span class="tab-text">–ó–∞–∫—É—Å–∫–∏</span>
            </button>
            <button class="tab-btn" data-filter="baking">
                <span class="tab-icon">ü•ê</span>
                <span class="tab-text">–í—ã–ø–µ—á–∫–∞</span>
            </button>
            <button class="tab-btn" data-filter="dessert">
                <span class="tab-icon">üç∞</span>
                <span class="tab-text">–î–µ—Å–µ—Ä—Ç—ã</span>
            </button>
            <div class="filter-divider"></div>
            <button class="tab-btn favorites-tab" data-filter="favorites">
                <span class="tab-icon">‚ù§Ô∏è</span>
                <span class="tab-text">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
            </button>
        </div>

        <!-- Recipe Grid -->
        <div class="recipe-grid" id="recipeGrid">
            <!-- Recipes will be dynamically added here -->
        </div>

        <!-- Weekly Menu Planner -->
        <div class="menu-planner" id="menuPlanner" style="display: none;">
            <div class="planner-header">
                <h2 class="planner-title"><span class="planner-emoji">üìÖ</span> <span class="planner-text">–ú–µ–Ω—é –Ω–∞ –Ω–µ–¥–µ–ª—é</span></h2>
                <button class="planner-action-btn" id="generateShoppingListBtn">
                    <span>üõí</span>
                    <span>–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</span>
                </button>
            </div>
            <div class="week-grid" id="weekGrid">
                <!-- Days will be dynamically added here -->
            </div>
        </div>

        <!-- Shopping List -->
        <div class="shopping-list" id="shoppingList" style="display: none;">
            <div class="shopping-header">
                <h2 class="shopping-title"><span class="shopping-emoji">üõí</span> <span class="shopping-text">–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</span></h2>
                <div class="shopping-actions">
                    <button class="shopping-action-btn primary" id="addShoppingItemBtn">
                        <span>‚ûï</span>
                        <span>–î–æ–±–∞–≤–∏—Ç—å</span>
                    </button>
                    <button class="shopping-action-btn warning" id="clearCompletedBtn">
                        <span>‚úÖ</span>
                        <span>–û—á–∏—Å—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</span>
                    </button>
                    <button class="shopping-action-btn danger" id="clearAllBtn">
                        <span>üóëÔ∏è</span>
                        <span>–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</span>
                    </button>
                </div>
            </div>
            <div class="shopping-items" id="shoppingItems">
                <!-- Shopping items will be dynamically added here -->
            </div>
            <div class="shopping-empty" id="shoppingEmpty">
                <div class="shopping-empty-icon">üõí</div>
                <h3>–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –ø—É—Å—Ç</h3>
                <p>–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–ª–∏ —Å—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–∑ –º–µ–Ω—é</p>
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState">
            <div class="empty-icon">üçΩÔ∏è</div>
            <h3>–†–µ—Ü–µ–ø—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
            <p>–ù–∞–∂–º–∏ "–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é!</p>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <form class="recipe-form" id="recipeForm">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞ *</label>
                    <input type="text" class="form-input" id="recipeName" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–∞—Å—Ç–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ *</label>
                    <select class="form-select" id="mealType" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                        <option value="first">üç≤ –ü–µ—Ä–≤–æ–µ –±–ª—é–¥–æ</option>
                        <option value="second">üçù –í—Ç–æ—Ä–æ–µ –±–ª—é–¥–æ</option>
                        <option value="salads">ü•ó –°–∞–ª–∞—Ç</option>
                        <option value="snacks">üç¢ –ó–∞–∫—É—Å–∫–∞</option>
                        <option value="baking">ü•ê –í—ã–ø–µ—á–∫–∞</option>
                        <option value="dessert">üç∞ –î–µ—Å–µ—Ä—Ç</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ—Ü–µ–ø—Ç *</label>
                    <input type="url" class="form-input" id="recipeUrl" required placeholder="https://...">
                </div>

                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea class="form-textarea" id="recipeDescription" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">–í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="text" class="form-input" id="cookingTime" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 30 –º–∏–Ω">
                </div>

                <div class="form-group">
                    <label class="form-label">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="url" class="form-input" id="imageUrl" placeholder="https://...">
                </div>

                <button type="submit" class="submit-btn">
                    <span class="btn-icon">üíæ</span>
                    <span class="btn-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span class="toast-icon">‚úÖ</span>
        <span class="toast-message">–†–µ—Ü–µ–ø—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!</span>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="deleteModal">
        <div class="modal-content delete-modal-content">
            <div class="delete-modal-icon">üóëÔ∏è</div>
            <h2 class="delete-modal-title">–£–¥–∞–ª–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç?</h2>
            <p class="delete-modal-text">–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–µ—Ü–µ–ø—Ç?</p>
            <div class="delete-modal-actions">
                <button class="delete-modal-btn cancel" id="cancelDelete">–û—Ç–º–µ–Ω–∞</button>
                <button class="delete-modal-btn confirm" id="confirmDelete">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Recipe Detail Modal -->
    <div class="modal" id="recipeDetailModal">
        <div class="modal-content recipe-detail-content">
            <div class="recipe-detail-header">
                <h2 class="recipe-detail-title" id="detailTitle">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞</h2>
                <button class="close-btn" id="closeDetailModal">&times;</button>
            </div>
            <div class="recipe-detail-body">
                <div class="recipe-detail-image" id="detailImage">
                    <span class="recipe-emoji">üçΩÔ∏è</span>
                </div>
                <div class="recipe-detail-info">
                    <div class="recipe-detail-type" id="detailType">üçΩÔ∏è –¢–∏–ø –±–ª—é–¥–∞</div>
                    <div class="recipe-detail-time" id="detailTime">‚è±Ô∏è –í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è</div>
                </div>
                <div class="recipe-detail-description">
                    <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                    <p id="detailDescription">–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞...</p>
                </div>
                <div class="recipe-detail-actions">
                    <a href="#" target="_blank" class="recipe-btn primary" id="detailUrl">
                        <span>üçΩÔ∏è</span>
                        <span>–û—Ç–∫—Ä—ã—Ç—å —Ä–µ—Ü–µ–ø—Ç</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Shopping Item Modal -->
    <div class="modal" id="shoppingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2>
                <button class="close-btn" id="closeShoppingModal">&times;</button>
            </div>
            <form class="shopping-form" id="shoppingForm">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                    <input type="text" class="form-input" id="shoppingItemName" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ–ª–æ–∫–æ">
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="text" class="form-input" id="shoppingItemQuantity" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 2 –ª">
                </div>
                <div class="form-group">
                    <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <select class="form-select" id="shoppingItemCategory">
                        <option value="">–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        <option value="vegetables">ü•ï –û–≤–æ—â–∏</option>
                        <option value="fruits">üçé –§—Ä—É–∫—Ç—ã</option>
                        <option value="meat">ü•© –ú—è—Å–æ</option>
                        <option value="fish">üêü –†—ã–±–∞</option>
                        <option value="dairy">üßÄ –ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã</option>
                        <option value="bakery">üçû –í—ã–ø–µ—á–∫–∞</option>
                        <option value="drinks">ü•§ –ù–∞–ø–∏—Ç–∫–∏</option>
                        <option value="snacks">üçø –ó–∞–∫—É—Å–∫–∏</option>
                        <option value="other">üì¶ –î—Ä—É–≥–æ–µ</option>
                    </select>
                </div>
                <button type="submit" class="submit-btn">
                    <span class="btn-icon">üíæ</span>
                    <span class="btn-text">–î–æ–±–∞–≤–∏—Ç—å –≤ —Å–ø–∏—Å–æ–∫</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-nav" id="mobileNav">
        <button class="mobile-nav-item" data-filter="all">
            <span class="mobile-nav-icon">üìñ</span>
            <span class="mobile-nav-label">–í—Å–µ</span>
        </button>
        <button class="mobile-nav-item" data-filter="first">
            <span class="mobile-nav-icon">üç≤</span>
            <span class="mobile-nav-label">–ü–µ—Ä–≤—ã–µ –±–ª—é–¥–∞</span>
        </button>
        <button class="mobile-nav-item" data-filter="second">
            <span class="mobile-nav-icon">üçù</span>
            <span class="mobile-nav-label">–í—Ç–æ—Ä—ã–µ –±–ª—é–¥–∞</span>
        </button>
        <button class="mobile-nav-item" data-filter="salads">
            <span class="mobile-nav-icon">ü•ó</span>
            <span class="mobile-nav-label">–°–∞–ª–∞—Ç—ã</span>
        </button>
        <button class="mobile-nav-item" data-filter="snacks">
            <span class="mobile-nav-icon">üç¢</span>
            <span class="mobile-nav-label">–ó–∞–∫—É—Å–∫–∏</span>
        </button>
        <button class="mobile-nav-item" data-filter="baking">
            <span class="mobile-nav-icon">ü•ê</span>
            <span class="mobile-nav-label">–í—ã–ø–µ—á–∫–∞</span>
        </button>
        <button class="mobile-nav-item" data-filter="dessert">
            <span class="mobile-nav-icon">üç∞</span>
            <span class="mobile-nav-label">–î–µ—Å–µ—Ä—Ç—ã</span>
        </button>
        <div class="mobile-nav-divider"></div>
        <button class="mobile-nav-item favorites-nav-item" data-filter="favorites">
            <span class="mobile-nav-icon">‚ù§Ô∏è</span>
            <span class="mobile-nav-label">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
        </button>
    </nav>

    <script src="script.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered: ', registration);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è! –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É?')) {
                                        newWorker.postMessage({ action: 'skipWaiting' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });

                        // Listen for controlling changes
                        navigator.serviceWorker.addEventListener('controllerchange', () => {
                            window.location.reload();
                        });
                    })
                    .catch((registrationError) => {
                        console.log('ServiceWorker registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
