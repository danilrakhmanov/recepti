<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üç≥ –ö–Ω–∏–≥–∞ –†–µ—Ü–µ–ø—Ç–æ–≤</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–†–µ—Ü–µ–ø—Ç—ã">
    <meta name="theme-color" content="#ff6b9d">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/512/2919/2919586.png" sizes="512x512">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2919/2919586.png">
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&family=Pacifico&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <canvas id="particlesCanvas" class="particles-canvas"></canvas>
    
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-spinner">
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
            </div>
            <div class="loading-text">
                <span class="loading-emoji">üç≥</span>
                <span class="loading-message">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤...</span>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1 class="title">
                <span class="title-icon">üç≥</span>
                <span class="title-text">–ö–Ω–∏–≥–∞ –†–µ—Ü–µ–ø—Ç–æ–≤</span>
                <span class="title-icon">üç∞</span>
            </h1>
            <p class="subtitle">–°–æ—Ö—Ä–∞–Ω—è–π –ª—é–±–∏–º—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</p>
        </header>

        <!-- Add Recipe Button -->
        <button class="add-recipe-btn" id="addRecipeBtn">
            <span class="btn-icon">‚ûï</span>
            <span class="btn-text">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</span>
        </button>

        <!-- Search Bar -->
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="üîç –ü–æ–∏—Å–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤...">
        </div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <button class="tab-btn active" data-filter="all">
                <span class="tab-icon">üìñ</span>
                <span class="tab-text">–í—Å–µ</span>
            </button>
            <button class="tab-btn" data-filter="first">
                <span class="tab-icon">üç≤</span>
                <span class="tab-text">–ü–µ—Ä–≤–æ–µ –±–ª—é–¥–æ</span>
            </button>
            <button class="tab-btn" data-filter="second">
                <span class="tab-icon">üçù</span>
                <span class="tab-text">–í—Ç–æ—Ä–æ–µ –±–ª—é–¥–æ</span>
            </button>
            <button class="tab-btn" data-filter="dessert">
                <span class="tab-icon">üç∞</span>
                <span class="tab-text">–î–µ—Å–µ—Ä—Ç</span>
            </button>
            <button class="tab-btn" data-filter="snacks">
                <span class="tab-icon">ü•ó</span>
                <span class="tab-text">–ó–∞–∫—É—Å–∫–∏</span>
            </button>
            <button class="tab-btn" data-filter="favorites">
                <span class="tab-icon">‚ù§Ô∏è</span>
                <span class="tab-text">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
            </button>
        </div>

        <!-- Recipe Grid -->
        <div class="recipe-grid" id="recipeGrid">
            <!-- Recipes will be dynamically added here -->
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState">
            <div class="empty-icon">üçΩÔ∏è</div>
            <h3>–†–µ—Ü–µ–ø—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
            <p>–ù–∞–∂–º–∏ "–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é!</p>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <form class="recipe-form" id="recipeForm">
                <div class="form-group">
                    <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞ *</label>
                    <input type="text" class="form-input" id="recipeName" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ü–∞—Å—Ç–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞">
                </div>
                
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –ø—Ä–∏—ë–º–∞ –ø–∏—â–∏ *</label>
                    <select class="form-select" id="mealType" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                        <option value="first">üç≤ –ü–µ—Ä–≤–æ–µ –±–ª—é–¥–æ</option>
                        <option value="second">üçù –í—Ç–æ—Ä–æ–µ –±–ª—é–¥–æ</option>
                        <option value="dessert">üç∞ –î–µ—Å–µ—Ä—Ç</option>
                        <option value="snacks">ü•ó –ó–∞–∫—É—Å–∫–∏</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ—Ü–µ–ø—Ç *</label>
                    <input type="url" class="form-input" id="recipeUrl" required placeholder="https://...">
                </div>

                <div class="form-group">
                    <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea class="form-textarea" id="recipeDescription" rows="3" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">–í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="text" class="form-input" id="cookingTime" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 30 –º–∏–Ω">
                </div>

                <div class="form-group">
                    <label class="form-label">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <input type="url" class="form-input" id="imageUrl" placeholder="https://...">
                </div>

                <button type="submit" class="submit-btn">
                    <span class="btn-icon">üíæ</span>
                    <span class="btn-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span class="toast-icon">‚úÖ</span>
        <span class="toast-message">–†–µ—Ü–µ–ø—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!</span>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="modal" id="deleteModal">
        <div class="modal-content delete-modal-content">
            <div class="delete-modal-icon">üóëÔ∏è</div>
            <h2 class="delete-modal-title">–£–¥–∞–ª–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç?</h2>
            <p class="delete-modal-text">–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ä–µ—Ü–µ–ø—Ç?</p>
            <div class="delete-modal-actions">
                <button class="delete-modal-btn cancel" id="cancelDelete">–û—Ç–º–µ–Ω–∞</button>
                <button class="delete-modal-btn confirm" id="confirmDelete">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered: ', registration);

                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è! –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É?')) {
                                        newWorker.postMessage({ action: 'skipWaiting' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });

                        // Listen for controlling changes
                        navigator.serviceWorker.addEventListener('controllerchange', () => {
                            window.location.reload();
                        });
                    })
                    .catch((registrationError) => {
                        console.log('ServiceWorker registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>
